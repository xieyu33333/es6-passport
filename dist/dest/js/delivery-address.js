!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n(require("vendors")):"function"==typeof define&&define.amd?define(["vendors"],n):"object"==typeof exports?exports.pass=n(require("vendors")):e.pass=n(e.vendors)}(this,function(e){return function(e){function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}var t={};return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},n.p="",n(n.s=3)}([function(e,n){e.exports=vendors},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(e,n){return fetch(e,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},credentials:"include",params:n}).then(function(e){if(!e.ok)throw Error(e.statusText);return e.json()})},a=function(e,n){return fetch(e,{method:"GET",headers:{},credentials:"include",params:n}).then(function(e){if(!e.ok)throw Error(e.statusText);return e.json()})};n.fetchPost=r,n.fetchJson=a},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r={domSelector:function(e){return window.document.querySelector(e)},getUrlParams:function(e){var n=location.search.replace(/^\?/,""),t={};return n.split("&").map(function(e){var n=e.split("=");t[n[0]]=n[1]}),e?t[e]:t},obj2query:function(e){if(e){var n=Object.keys(e).filter(function(n){return""!==e[n]&&null!==e[n]}).map(function(n){return n+"="+e[n]}).join("&");return n.length>0?"?"+n:null}},hasClass:function(e,n){return e.className.match(new RegExp("(\\s|^)"+n+"(\\s|$)"))},addClass:function(e,n){e.className.trim(),r.hasClass(e,n)||(e.className+=" "+n)},removeClass:function(e,n){if(r.hasClass(e,n)){var t=new RegExp("(\\s|^)"+n+"(\\s|$)");e.className=e.className.replace(t," ")}},isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},isObject:function(e){return"[object Object]"===Object.prototype.toString.call(e)},bindEvent:function(){var e=void 0,n=void 0,t=void 0,r=function n(t,r,a){t!==a&&(document.querySelector(r).className===t.className?e=t:n(t.parentNode,r,a))},a=arguments[0],i=arguments[1];"string"==typeof arguments[2]?(n=arguments[2],"function"==typeof arguments[3]&&(t=arguments[3])):"function"==typeof arguments[2]&&(t=arguments[2]),a.addEventListener(i,function(i){n?n&&(r(i.target,n,a),e&&t.call(e,{target:e})):t.call(a,i)})}};n.default=r},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.delivery=void 0,t(4);var r=t(10),a=function(e){return e&&e.__esModule?e:{default:e}}(r),i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n={},t=Object.assign(n,e);(0,a.default)(t)};n.delivery=i},function(e,n,t){"use strict";t(5),t(6),t(7),t(8),t(9)},function(e,n,t){e.exports=t(0)(125)},function(e,n,t){e.exports=t(0)(126)},function(e,n,t){e.exports=t(0)(328)},function(e,n,t){e.exports=t(0)(332)},function(e,n,t){e.exports=t(0)(333)},function(e,n,t){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e){return function(){var n=e.apply(this,arguments);return new Promise(function(e,t){function r(a,i){try{var o=n[a](i),s=o.value}catch(e){return void t(e)}if(!o.done)return Promise.resolve(s).then(function(e){r("next",e)},function(e){r("throw",e)});e(s)}return r("next")})}}Object.defineProperty(n,"__esModule",{value:!0});var i=t(1),o=t(2),s=r(o),u=t(11),d=r(u),c=t(12),l=r(c),f=s.default.getUrlParams,p=void 0,v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.data,t=void 0;e.addrId?(t=n.filter(function(n){return parseInt(e.addrId)===n.addrId})[0],p=t.regionCode?t.regionCode.split(",").map(function(e){return parseInt(e)}):""):t={};var r='\n    <div id="delivery-address-wrapper" class="delivery-address-wrapper">\n        <form id="delivery-address-form" onsubmit="return false">\n            <input id="delivery-address-id" name="addrId" type="hidden" value="'+(t.addrId||"")+'">\n            <label>\n                <span>省市区：</span>\n                <div id="delivery-address-region"></div>\n            </label>\n            <label>\n                <span>详细地址：</span>\n                <textarea id="delivery-address-detail" name="detailAddress"  placeholder="详细地址" valid="present" rows="3" cols="20">'+(t.detailAddress||"")+'</textarea>\n            </label>\n            <label>\n                <span>邮政编码：</span>\n                <input id="delivery-address-email" name="postalcode" type="text" placeholder="邮政编码" value="'+(t.postalcode||"")+'">\n            </label>\n            <label>\n                <span>收货人姓名：</span>\n                <input id="delivery-address-name" name="name" type="text" placeholder="真实姓名" value="'+(t.name||"")+'" valid="present">\n            </label>\n            <label>\n                <span>手机号码：</span>\n                <input id="delivery-address-mobile" name="mobile" type="text" placeholder="手机号码" value="'+(t.mobile||"")+'" valid="present, mobile">\n            </label>\n            <label>\n                <span>固定电话：</span>\n                <input id="delivery-address-telphone" name="telphone" type="text" placeholder="固话号码" value="'+(t.telephone||"")+'">\n            </label>\n            <label>\n                <span>&nbsp;</span>\n                <input id="save-delivery-address" type="submit" value="保存">\n            </label>\n\n        </form>\n\n        <div class="delivery-address-list" id="delivery-address-list">\n            <table>\n                <tr>\n                    <th>\n                        收货人\n                    </th>\n                    <th>\n                        所在地区\n                    </th>\n                    <th>\n                        详细地址\n                    </th>\n                    <th>\n                        邮编\n                    </th>\n                    <th>\n                        手机/固话\n                    </th>\n                    <th>\n                        操作\n                    </th>\n                <tr>\n\n';return n.forEach(function(e){r+="\n        <tr>\n            <td>\n                "+e.name+"\n            </td>\n            <td>\n                "+e.regionSting+"\n            </td>\n            <td>\n                "+e.detailAddress+"\n            </td>\n            <td>\n                "+e.postalcode+"\n            </td>\n            <td>\n                "+(e.mobile||e.telephone)+'\n            </td>\n            <td>\n                <a href="javascript:void(0);" class="del-delivery-address" data-id="'+e.addrId+'">删除</a> | <a href="/html/delivery-address.html?addrId='+e.addrId+'">修改</a>\n            </td>\n        <tr>'}),r+="</table>\n        </div>\n    </div>",r};n.default=function(){var e=a(regeneratorRuntime.mark(function e(n){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,i.fetchJson)("/delivery-address",{});case 2:t=e.sent,200===t.code?(n.container.innerHTML=v({data:t.data,addrId:f("addrId")}),r=new d.default({container:document.getElementById("delivery-address-region"),name:"region",present:!0,initData:p}),(0,l.default)(n)):alert("数据拉取失败");case 4:case"end":return e.stop()}},e,void 0)}));return function(n){return e.apply(this,arguments)}}()},function(e,n,t){"use strict";function r(e){return function(){var n=e.apply(this,arguments);return new Promise(function(e,t){function r(a,i){try{var o=n[a](i),s=o.value}catch(e){return void t(e)}if(!o.done)return Promise.resolve(s).then(function(e){r("next",e)},function(e){r("throw",e)});e(s)}return r("next")})}}function a(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}(),o=t(2),s=function(e){return e&&e.__esModule?e:{default:e}}(o),u=t(1),d=s.default.domSelector,c=s.default.isArray,l=Symbol("render"),f=function(){function e(n){if(a(this,e),!n.container)throw"请填写container配置";if(!n.name)throw"请填写name配置";this[l](n)}return i(e,[{key:l,value:function(){function e(e){return n.apply(this,arguments)}var n=r(regeneratorRuntime.mark(function e(n){var t,r,a,i,o,s,l,f,p,v,m,h,y,b;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,u.fetchJson)("/region-data",{});case 2:t=e.sent,t=t.data,r='\n        <div class="region-select-wrapper">\n            <select id="region-province-select"></select>\n            <select id="region-city-select"></select>\n            <select id="region-area-select"></select>\n            <input id="region-selected" name="'+n.name+'" type="hidden" valid="'+(n.present?"present":"")+'">\n        </div>\n        ',n.container.innerHTML=r,a=d("#region-province-select"),i=d("#region-city-select"),o=d("#region-area-select"),s=d("#region-selected"),l=void 0,f=void 0,p=void 0,v="<option></option>",t.forEach(function(e){v+='<option value="'+e.id+'">'+e.name+"</option>"}),a.innerHTML=v,m=function(e){var n=e||parseInt(a.value),r=t[n-1].city,o="";l=n,r.forEach(function(e){o+='<option value="'+e.id+'">'+e.name+"</option>"}),i.innerHTML=o,e&&(a.value=e)},h=function(e){var n=t[l-1].city.filter(function(e){return e.id===parseInt(i.value)})[0].district,r="";f=parseInt(i.value),n.forEach(function(e){r+='<option value="'+e.id+'">'+e.name+"</option>"}),o.innerHTML=r,e&&(i.value=e)},y=function(e){p=parseInt(o.value),s.value=l+","+f+","+p,e&&(o.value=e)},n.initData&&c(n.initData)&&(b=n.initData,b[0]&&m(b[0]),b[1]&&h(b[1]),b[2]&&y(b[2])),a.onchange=function(e){m(),h(),y()},i.onchange=function(e){h(),y()},o.onchange=function(e){y()};case 23:case"end":return e.stop()}},e,this)}));return e}()}]),e}();n.default=f},function(e,n,t){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e){return function(){var n=e.apply(this,arguments);return new Promise(function(e,t){function r(a,i){try{var o=n[a](i),s=o.value}catch(e){return void t(e)}if(!o.done)return Promise.resolve(s).then(function(e){r("next",e)},function(e){r("throw",e)});e(s)}return r("next")})}}Object.defineProperty(n,"__esModule",{value:!0});var i=t(1),o=t(2),s=r(o),u=t(13),d=r(u),c=s.default.domSelector,l=s.default.bindEvent;n.default=function(e){var n=c("#save-delivery-address"),t=c("#delivery-address-list"),r=c("#delivery-address-form"),o={name:"收货人姓名",region:"所在地信息",detailAddress:"详细地址",mobile:"手机号码"},s=new d.default({form:r});l(t,"click",".del-delivery-address",function(){var e=a(regeneratorRuntime.mark(function e(n){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!confirm("是否删除该条收货地址")){e.next=5;break}return e.next=3,(0,i.fetchPost)("/del-delivery",{addrId:n.target.getAttribute("data-id")});case 3:t=e.sent,200===t.code&&location.reload();case 5:case"end":return e.stop()}},e,void 0)}));return function(n){return e.apply(this,arguments)}}()),n.onclick=a(regeneratorRuntime.mark(function n(){var t,a,u,d,c;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t=s.check(),t.length){n.next=10;break}return a={},Array.from(r.elements).forEach(function(e){e.name&&(a[e.name]=e.value)}),n.next=6,(0,i.fetchPost)("/save-delivery",a);case 6:u=n.sent,200===u.code?(alert("保存成功"),e.success&&e.success()):alert("保存失败"),n.next=13;break;case 10:d=t[0].type,c=t[0].name,"present"===d?alert("请填写您的"+o[c]):alert("请填写正确的"+o[c]);case 13:case"end":return n.stop()}},n,void 0)}))}},function(e,n,t){"use strict";function r(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}(),i=function(e){return"您填写的"+e+"格式不正确"},o={email:function(e){if(!e.match(/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/))return{type:"email",message:i("邮箱")}},mobile:function(e){if(!e.match(/^1(3|4|5|7|8)\d{9}$/))return{type:"mobile",message:i("手机号")}},IDcard:function(e){return{type:"IDcard",message:i("身份证号")}},present:function(e){if(!e.trim())return{type:"present",message:"必填"}}},s=function(){function e(n){r(this,e),this.opts=n}return a(e,[{key:"check",value:function(e){var n=this.opts.form.elements||document.getElementById(this.opts.form).elements,t=[];return Array.from(n).filter(function(e){return e.getAttribute("valid")}).map(function(e){var n=e.getAttribute("valid").split(", "),r=e.value,a=[];n.forEach(function(e){if(o[e]){var n=o[e](r);n&&a.push(n)}}),a.length&&t.push({dom:e,errorArr:a,name:e.name,message:a[0].message,type:a[0].type})}),t}}]),e}();n.default=s}])});